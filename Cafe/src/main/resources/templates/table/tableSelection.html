<!DOCTYPE html>
<html lang="en" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout" xmlns:th="http://www.thymeleaf.org">


<head>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <link href='https://unpkg.com/boxicons@2.1.1/css/boxicons.min.css' rel='stylesheet'>
    <title>Table Selection</title>
    <link rel="stylesheet" href="../style/table.css">
    <link rel="stylesheet" href="../style/homepage.css">

    <style>
        .ttext.busy {
            background-color: red !important;
        }

        .ttext.unpaid {
            background-color: rgb(255, 145, 0) !important;
        }

        .ttext {
            background-color: green !important;
        }

        .img-container {
            width: 100%;
            height: 160px;
            margin: auto;
            overflow: hidden;
            cursor: pointer;
        }

        .store-img {
            transition: all 1s ease-in-out;
        }

        .img-container:hover .store-img {
            transform: scale(1.3);
        }

        .img-container:hover {
            transform: translate(0, 0);
        }
        .disable{
            pointer-events: none;
        }
    </style>
</head>

<body>
    <div>
        <nav class="navbar navbar-expand-lg navbar-light justify-content-between w-100 d-flex">
            <div class="logo d-flex w-25 justify-content-center img-container">
                <img src="../img/logo.png" alt="logo" class="store-img">
                <a class="navbar-brand justify-content-center text-center" href="#">
                    <p>Gic Cafe</p>
                </a>
            </div>

            <button class="navbar-toggler " type="button" data-toggle="collapse" data-target="#navbarNavAltMarkup"
                aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse w-75 justify-content-between" id="navbarNavAltMarkup">
                <div class="navbar-nav w-50 justify-content-between ml-50" style="margin-left: 40%;">
                    <a class="nav-item nav-link active" href="/" th:href="@{/homepageCashier}" id="Home">
                        <h5 class="fs-1">Home</h5>
                    </a>
                    <a class="nav-item nav-link" href="/" th:href="@{/homepageCashier}" id="AboutUs">
                        <h5 class="fs-1">About Us</h5>
                    </a>
                    <a class="nav-item nav-link" href="/" th:href="@{/homepageCashier}" id="Menu">
                        <h5 class="fs-1">Menu</h5>
                    </a>
                    <a class="nav-item nav-link" href="/" th:href="@{/logout}">
                        <h5 class="fs-1">LogOut</h5>
                    </a>
                </div>
            </div>
        </nav>

        <div class="body border-1 m-auto justify-content-between">

            <div class="table border-1">
                <div class="type active row m-auto mt-5 overflow-scroll" data-filter="all">

                    <div class="itemBox col-5 my-4 d-flex justify-content-between w-50" th:each="tables: ${tables}"
                        th:if="${tables.stage == 'Available'}">
                        <button th:text="${tables.id}" class="ttext w-50 h-100" th:id="${tables.id}"
                            style="cursor: pointer; margin-left: 20%;"></button>

                    </div>


                    <div class="itemBox col-5 my-4 d-flex justify-content-between w-50" th:each="tables: ${tables}"
                        th:if="${tables.stage == 'Busy'}">
                        <button th:text="${tables.id}" class="ttext busy w-50 h-100" th:id="${tables.id}"
                            style="cursor: pointer; margin-left: 20%;"></button>

                    </div>


                    <div class="itemBox col-5 my-4 d-flex justify-content-between w-50" th:each="tables: ${tables}"
                        th:if="${tables.stage == 'Unpaid'}">
                        <button th:text="${tables.id}" class="ttext unpaid w-50 h-100" th:id="${tables.id}"
                            style="cursor: pointer; margin-left: 20%;"></button>

                    </div>

                </div>

            </div>

            <div class="table border-1 overflow-scroll" style="background-color:  rgb(179, 227, 235);">
                <div class="infoo ">

                    <p class="text-center">Table Information</p>

                    <div class="d-flex">

                        <div>
                            <h5>Table &nbsp;&nbsp;</h5>
                            <h5>Stage &nbsp;&nbsp;</h5>
                        </div>

                        <div th:each="tables: ${tables}" class="tnum d-none" th:id="${'tnum' + tables.id}">

                            <h5 th:text="${tables.number}"> </h5>
                            <h5 th:class="${'stage'+tables.id}" th:text="${tables.stage}"></h5>

                            <div>
                                <a th:href="@{/editTable/{id}(id=${tables.id})}"><i class="bx bxs-message-square-edit"></i> Edit</a>
                            </div>

                        </div>
                        
                    </div>

                    <div class="text-decoration-none text-right">
                        <a id="next" href="/" th:href="@{/drinkOrder}">
                            <h5 class="fs-1">Next</h5>
                        </a>
                    </div>

                </div>
            </div>
        </div>

        <script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>


        <script>

            let tableID=null;
            const tables = document.getElementsByClassName("ttext");
            const tableSelected = e => {
                // Get ID of Clicked Element
                tableID = e.target.id;
                let numbers = document.getElementsByClassName("tnum");


                for (let number of numbers) {
                    number.classList.add('d-none');
                }
                document.getElementById("tnum" + tableID).classList.remove('d-none');
                showNext()
            }

            for (let table of tables) {
                table.addEventListener("click", tableSelected);
            }

            //for select table

            document.querySelector('#next').addEventListener('click', (e) => {
                if( tableID==null){
                    Swal.fire({
                        icon: 'error',
                        title: "UnValid Selection",
                        text: 'Please select the table'
                    })
                    e.preventDefault()
                    return
                }
                // console.log(document.querySelector(`.stage${tableID}`),document.querySelector(`.stage${tableID}`).innerText=='Busy');
                if (document.querySelector(`.stage${tableID}`).innerText == 'Busy' || document.querySelector(`.stage${tableID}`).innerText == 'Unpaid' ) {
                    // console.log($('#exampleModalCenter').modal);
                    Swal.fire({
                        icon: 'error',
                        title: "UnValid Selection",
                        text: 'Please select the table which is Available!!'
                    })
                    // document.querySelector('#next').clicked()

                    e.preventDefault()
                    // return
                }
                // console.log("Test");
            })

        </script>
</body>

</html>